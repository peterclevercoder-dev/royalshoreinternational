<!doctype html>
<html lang="en" class="h-full bg-gray-50">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}{{ title }} - RSIB{% endblock %}</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Custom Tailwind Config -->
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: {
                50: "#eff6ff",
                100: "#dbeafe",
                200: "#bfdbfe",
                300: "#93c5fd",
                400: "#60a5fa",
                500: "#3b82f6",
                600: "#2563eb",
                700: "#1d4ed8",
                800: "#1e40af",
                900: "#1e3a8a",
              },
            },
            fontFamily: {
              sans: ["Inter", "system-ui", "-apple-system", "sans-serif"],
            },
          },
        },
      };
    </script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
      rel="stylesheet"
    />

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <style>
      body {
        font-family: "Inter", sans-serif;
      }

      html {
        scroll-behavior: smooth;
      }

      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }

      ::-webkit-scrollbar-track {
        background: #f1f1f1;
      }

      ::-webkit-scrollbar-thumb {
        background: rgb(35, 35, 222);
        border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: rgb(20, 20, 220);
      }

      @keyframes slideDown {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes slideInLeft {
        from {
          transform: translateX(-100%);
        }
        to {
          transform: translateX(0);
        }
      }

      .animate-slideDown {
        animation: slideDown 0.3s ease-out;
      }

      .animate-slideInLeft {
        animation: slideInLeft 0.3s ease-out;
      }

      .gradient-text {
        background: linear-gradient(135deg, #2932db 0%, #1b2199 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .glass-effect {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
      }

      /* Sidebar active state */
      .nav-item-active {
        background: linear-gradient(
          135deg,
          #3e26dc 0%,
          #1d1b99 100%
        ) !important;
        color: white !important;
      }

      .nav-item-active i,
      .nav-item-active span {
        color: white !important;
      }

      .nav-item-active:hover {
        background: linear-gradient(
          135deg,
          #1c50b9 0%,
          #153282 100%
        ) !important;
        color: white !important;
      }

      .nav-item-active:hover i,
      .nav-item-active:hover span {
        color: white !important;
      }

      /* ===== GLOBAL RESPONSIVE STYLES ===== */

      /* Mobile-first responsive font scaling */
      @media (max-width: 640px) {
        /* Scale down large headings on mobile */
        .text-4xl { font-size: 1.5rem !important; line-height: 2rem !important; }
        .text-3xl { font-size: 1.25rem !important; line-height: 1.75rem !important; }
        .text-2xl { font-size: 1.125rem !important; line-height: 1.5rem !important; }
        .text-xl { font-size: 1rem !important; line-height: 1.5rem !important; }
        .text-lg { font-size: 0.938rem !important; line-height: 1.375rem !important; }

        /* Scale down large icon text inside elements */
        .text-6xl { font-size: 2.5rem !important; }
        .text-5xl { font-size: 2rem !important; }
        .text-8xl { font-size: 3.5rem !important; }

        /* Responsive form inputs */
        input[type="text"],
        input[type="email"],
        input[type="password"],
        input[type="number"],
        input[type="tel"],
        input[type="date"],
        input[type="url"],
        select,
        textarea {
          font-size: 16px !important; /* Prevents iOS zoom on focus */
          padding: 0.625rem 0.75rem !important;
        }

        /* Responsive buttons */
        button, .btn, [type="submit"] {
          font-size: 0.875rem !important;
          padding-left: 1rem !important;
          padding-right: 1rem !important;
        }

        /* Responsive padding for cards/sections */
        .p-6 { padding: 1rem !important; }
        .p-8 { padding: 1.25rem !important; }
        .p-12 { padding: 1.5rem !important; }
        .px-6 { padding-left: 1rem !important; padding-right: 1rem !important; }
        .px-8 { padding-left: 1.25rem !important; padding-right: 1.25rem !important; }
        .py-12 { padding-top: 1.5rem !important; padding-bottom: 1.5rem !important; }

        /* Responsive margins */
        .mb-8 { margin-bottom: 1.25rem !important; }
        .mb-12 { margin-bottom: 1.5rem !important; }
        .space-y-6 > :not([hidden]) ~ :not([hidden]) {
          --tw-space-y-reverse: 0;
          margin-top: 1rem;
        }
        .gap-6 { gap: 1rem !important; }
        .gap-8 { gap: 1.25rem !important; }

        /* Prevent horizontal overflow */
        body, html {
          overflow-x: hidden;
        }

        /* Responsive tables - make them scrollable */
        table {
          display: block;
          overflow-x: auto;
          -webkit-overflow-scrolling: touch;
        }

        /* Responsive font-mono (account numbers, card numbers) */
        .font-mono {
          font-size: 0.813rem !important;
          word-break: break-all;
        }

        /* Ensure images don't overflow */
        img {
          max-width: 100%;
          height: auto;
        }

        /* Responsive stat/balance numbers */
        .text-3xl.font-bold,
        .text-2xl.font-bold {
          font-size: 1.25rem !important;
          line-height: 1.75rem !important;
        }

        /* Mobile card grid fixes */
        .grid-cols-2 {
          grid-template-columns: repeat(2, minmax(0, 1fr));
        }

        /* Fix flex wrapping on small screens */
        .flex.items-center.justify-between {
          flex-wrap: wrap;
          gap: 0.5rem;
        }

        /* Ensure modals are mobile-friendly */
        .max-w-md, .max-w-lg, .max-w-xl, .max-w-2xl, .max-w-4xl, .max-w-5xl, .max-w-6xl {
          max-width: 100% !important;
          margin-left: 0.5rem;
          margin-right: 0.5rem;
        }

        /* Fix mobile top bar content area offset */
        .pt-20 {
          padding-top: 4.5rem !important;
        }
      }

      /* Tablet adjustments */
      @media (min-width: 641px) and (max-width: 1023px) {
        .text-4xl { font-size: 1.875rem !important; }
        .text-3xl { font-size: 1.5rem !important; }

        .p-12 { padding: 2rem !important; }
        .p-8 { padding: 1.5rem !important; }
      }

      /* Ensure all containers respect viewport */
      * {
        max-width: 100vw;
      }

      /* Fix for long text overflow */
      .truncate {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }

      /* Responsive grid helper - stack on mobile */
      @media (max-width: 640px) {
        .grid.grid-cols-3:not(.sm\:grid-cols-3),
        .grid.grid-cols-4:not(.sm\:grid-cols-4) {
          grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
        }
      }
    </style>

    {% block extra_css %}{% endblock %}
  </head>
  <body class="h-full antialiased bg-gray-50">
    {% load currency_filters %}

    <!-- Flash Messages -->
    {% if messages %}
    <div class="fixed top-4 right-4 z-50 space-y-2 max-w-md">
      {% for message in messages %}
      <div
        class="animate-slideDown bg-white rounded-lg shadow-xl border-l-4 {% if message.tags == 'success' %}border-green-500{% elif message.tags == 'error' %}border-blue-500{% elif message.tags == 'warning' %}border-yellow-500{% else %}border-blue-500{% endif %} p-4 flex items-start space-x-3"
      >
        <div class="flex-shrink-0">
          {% if message.tags == 'success' %}
          <i class="fas fa-check-circle text-green-500 text-xl"></i>
          {% elif message.tags == 'error' %}
          <i class="fas fa-times-circle text-blue-500 text-xl"></i>
          {% elif message.tags == 'warning' %}
          <i class="fas fa-exclamation-triangle text-yellow-500 text-xl"></i>
          {% else %}
          <i class="fas fa-info-circle text-blue-500 text-xl"></i>
          {% endif %}
        </div>
        <div class="flex-1">
          <p class="text-sm font-medium text-gray-900">{{ message }}</p>
        </div>
        <button
          type="button"
          class="flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors"
          onclick="this.parentElement.remove()"
        >
          <i class="fas fa-times"></i>
        </button>
      </div>
      {% endfor %}
    </div>
    {% endif %} {% if user.is_authenticated %}
    <!-- Authenticated User Layout with Sidebar -->
    <div class="flex h-screen overflow-hidden">
      <!-- Sidebar for Desktop -->
      <aside class="hidden lg:flex lg:flex-shrink-0">
        <div class="flex flex-col w-64 bg-white border-r border-gray-200">
          <!-- Logo -->
          <div
            class="flex items-center justify-center h-16 px-4 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-white"
          >
            <a
              href="{% url 'dashboard' %}"
              class="flex items-center space-x-3 group"
            >
              
              <img class="w-40" id="logo" src="https://res.cloudinary.com/dulduri72/image/upload/v1769091523/ROYAL_shore_cqtrat.png" alt="">
            </a>
          </div>

          <!-- Navigation Links -->
          <nav class="flex-1 overflow-y-auto py-4 px-3 space-y-1">
            <a
              href="{% url 'dashboard' %}"
              class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all duration-200 group {% if request.resolver_match.url_name == 'dashboard' %}nav-item-active{% endif %}"
            >
              <i
                class="fas fa-home w-5 mr-3 text-gray-400 group-hover:text-blue-600"
              ></i>
              <span>Dashboard</span>
            </a>

            <a
              href="{% url 'account_list' %}"
              class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all duration-200 group {% if 'account' in request.resolver_match.url_name %}nav-item-active{% endif %}"
            >
              <i
                class="fas fa-wallet w-5 mr-3 text-gray-400 group-hover:text-blue-600"
              ></i>
              <span>Accounts</span>
            </a>

            <a
              href="{% url 'card_list' %}"
              class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all duration-200 group {% if 'card' in request.resolver_match.url_name %}nav-item-active{% endif %}"
            >
              <i
                class="fas fa-credit-card w-5 mr-3 text-gray-400 group-hover:text-blue-600"
              ></i>
              <span>Cards</span>
            </a>

            <a
              href="{% url 'transaction_list' %}"
              class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all duration-200 group {% if 'transaction' in request.resolver_match.url_name %}nav-item-active{% endif %}"
            >
              <i
                class="fas fa-exchange-alt w-5 mr-3 text-gray-400 group-hover:text-blue-600"
              ></i>
              <span>Transactions</span>
            </a>

            <a
              href="{% url 'transfer' %}"
              class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all duration-200 group {% if request.resolver_match.url_name == 'transfer' %}nav-item-active{% endif %}"
            >
              <i
                class="fas fa-paper-plane w-5 mr-3 text-gray-400 group-hover:text-blue-600"
              ></i>
              <span>Transfer</span>
            </a>

            <a
              href="{% url 'beneficiary_list' %}"
              class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all duration-200 group {% if 'beneficiary' in request.resolver_match.url_name %}nav-item-active{% endif %}"
            >
              <i
                class="fas fa-users w-5 mr-3 text-gray-400 group-hover:text-blue-600"
              ></i>
              <span>Beneficiaries</span>
            </a>

            <!-- Divider -->
            <div class="pt-4 mt-4 border-t border-gray-200">
              <p
                class="px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2"
              >
                Support
              </p>
            </div>

            <a
              href="{% url 'support_ticket_list' %}"
              class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all duration-200 group {% if 'support' in request.resolver_match.url_name %}nav-item-active{% endif %}"
            >
              <i
                class="fas fa-headset w-5 mr-3 text-gray-400 group-hover:text-blue-600"
              ></i>
              <span>Support Tickets</span>
            </a>

            <a
              href="{% url 'notification_list' %}"
              class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all duration-200 group {% if 'notification' in request.resolver_match.url_name %}nav-item-active{% endif %}"
            >
              <i
                class="fas fa-bell w-5 mr-3 text-gray-400 group-hover:text-blue-600"
              ></i>
              <span>Notifications</span>
              {% if unread_notifications_count > 0 %}
              <span
                class="ml-auto bg-blue-600 text-white text-xs px-2 py-0.5 rounded-full font-semibold"
                >{{ unread_notifications_count }}</span
              >
              {% endif %}
            </a>
          </nav>

          <!-- User Profile Section -->
          <div class="border-t border-gray-200 p-4">
            <div class="flex items-center space-x-3 mb-3">
              {% if user.profile_image %}
              <img src="{{ user.profile_image.url }}" alt="{{ user.get_full_name }}" class="w-10 h-10 rounded-full object-cover" id="profileImage">
              {% else %}
              <div
                class="w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-700 rounded-full flex items-center justify-center text-white font-semibold shadow-lg"
              >
                {{ user.first_name.0|upper }}{{ user.last_name.0|upper }}
              </div>
              {% endif %}
              <div class="flex-1 min-w-0">
                <p class="text-sm font-semibold text-gray-900 truncate">
                  {{ user.get_full_name }}
                </p>
                <p class="text-xs text-gray-500 truncate">{{ user.email }}</p>
              </div>
            </div>
            <div class="grid grid-cols-2 gap-2">
              <a
                href="{% url 'profile' %}"
                class="flex items-center justify-center px-3 py-2 text-xs font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors"
              >
                <i class="fas fa-user mr-1.5"></i>Profile
              </a>
              <a
                href="{% url 'logout' %}"
                class="flex items-center justify-center px-3 py-2 text-xs font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors"
              >
                <i class="fas fa-sign-out-alt mr-1.5"></i>Logout
              </a>
            </div>
          </div>
        </div>
      </aside>

      <!-- Mobile Sidebar Overlay -->
      <div x-data="{ sidebarOpen: false }" class="lg:hidden">
        <!-- Mobile Top Bar -->
        <div
          class="fixed top-0 left-0 right-0 h-16 bg-white border-b border-gray-200 z-40 flex items-center justify-between px-4"
        >
          <button
            @click="sidebarOpen = true"
            class="p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all"
          >
            <i class="fas fa-bars text-xl"></i>
          </button>

          <a href="{% url 'dashboard' %}" class="flex items-center space-x-2">
            <img class="w-40" src="https://res.cloudinary.com/dulduri72/image/upload/v1769091523/ROYAL_shore_cqtrat.png" alt="">

          </a>

          <a
            href="{% url 'notification_list' %}"
            class="relative p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all"
          >
            <i class="fas fa-bell text-xl"></i>
            {% if unread_notifications_count > 0 %}
            <span
              class="absolute top-0 right-0 block h-5 w-5 rounded-full bg-blue-600 text-white text-xs flex items-center justify-center font-semibold"
            >
              {{ unread_notifications_count }}
            </span>
            {% endif %}
          </a>
        </div>

        <!-- Mobile Sidebar -->
        <div
          x-show="sidebarOpen"
          @click="sidebarOpen = false"
          x-transition:enter="transition-opacity ease-linear duration-300"
          x-transition:enter-start="opacity-0"
          x-transition:enter-end="opacity-100"
          x-transition:leave="transition-opacity ease-linear duration-300"
          x-transition:leave-start="opacity-100"
          x-transition:leave-end="opacity-0"
          class="fixed inset-0 bg-gray-900 bg-opacity-50 z-50"
          style="display: none"
        ></div>

        <div
          x-show="sidebarOpen"
          @click.away="sidebarOpen = false"
          x-transition:enter="transition ease-out duration-300"
          x-transition:enter-start="-translate-x-full"
          x-transition:enter-end="translate-x-0"
          x-transition:leave="transition ease-in duration-300"
          x-transition:leave-start="translate-x-0"
          x-transition:leave-end="-translate-x-full"
          class="fixed inset-y-0 left-0 w-64 bg-white shadow-xl z-50 transform"
          style="display: none"
        >
          <div class="flex flex-col h-full">
            <!-- Mobile Logo -->
            <div
              class="flex items-center justify-between h-16 px-4 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-white"
            >
              <a
                href="{% url 'dashboard' %}"
                class="flex items-center space-x-3"
              >
                <img class="w-40" src="https://res.cloudinary.com/dulduri72/image/upload/v1769091523/ROYAL_shore_cqtrat.png" alt="">

              </a>
              <button
                @click="sidebarOpen = false"
                class="p-2 text-gray-400 hover:text-gray-600"
              >
                <i class="fas fa-times text-xl"></i>
              </button>
            </div>

            <!-- Mobile Navigation -->
            <nav class="flex-1 overflow-y-auto py-4 px-3 space-y-1">
              <a
                href="{% url 'dashboard' %}"
                class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all duration-200"
              >
                <i class="fas fa-home w-5 mr-3"></i>Dashboard
              </a>
              <a
                href="{% url 'account_list' %}"
                class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all duration-200"
              >
                <i class="fas fa-wallet w-5 mr-3"></i>Accounts
              </a>
              <a
                href="{% url 'card_list' %}"
                class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all duration-200"
              >
                <i class="fas fa-credit-card w-5 mr-3"></i>Cards
              </a>
              <a
                href="{% url 'transaction_list' %}"
                class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all duration-200"
              >
                <i class="fas fa-exchange-alt w-5 mr-3"></i>Transactions
              </a>
              <a
                href="{% url 'transfer' %}"
                class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all duration-200"
              >
                <i class="fas fa-paper-plane w-5 mr-3"></i>Transfer
              </a>
              <a
                href="{% url 'beneficiary_list' %}"
                class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all duration-200"
              >
                <i class="fas fa-users w-5 mr-3"></i>Beneficiaries
              </a>

              <div class="pt-4 mt-4 border-t border-gray-200">
                <p
                  class="px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2"
                >
                  Support
                </p>
              </div>

              <a
                href="{% url 'support_ticket_list' %}"
                class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all duration-200"
              >
                <i class="fas fa-headset w-5 mr-3"></i>Support Tickets
              </a>
              <a
                href="{% url 'notification_list' %}"
                class="flex items-center px-4 py-3 text-sm font-medium text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all duration-200"
              >
                <i class="fas fa-bell w-5 mr-3"></i>
                <span>Notifications</span>
                {% if unread_notifications_count > 0 %}
                <span
                  class="ml-auto bg-blue-600 text-white text-xs px-2 py-0.5 rounded-full font-semibold"
                  >{{ unread_notifications_count }}</span
                >
                {% endif %}
              </a>
            </nav>

            <!-- Mobile User Profile -->
            <div class="border-t border-gray-200 p-4">
              <div class="flex items-center space-x-3 mb-3">
                {% if user.profile_image %}
                <img src="{{ user.profile_image.url }}" alt="{{ user.get_full_name }}" class="w-10 h-10 object-cover" id="profileImage">
                {% else %}
                <div
                  class="w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-700 rounded-full flex items-center justify-center text-white font-semibold shadow-lg"
                >
                  {{ user.first_name.0|upper }}{{ user.last_name.0|upper }}
                </div>
                {% endif %}
                <div class="flex-1 min-w-0">
                  <p class="text-sm font-semibold text-gray-900 truncate">
                    {{ user.get_full_name }}
                  </p>
                  <p class="text-xs text-gray-500 truncate">{{ user.email }}</p>
                </div>
              </div>
              <div class="grid grid-cols-2 gap-2">
                <a
                  href="{% url 'profile' %}"
                  class="flex items-center justify-center px-3 py-2 text-xs font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors"
                >
                  <i class="fas fa-user mr-1.5"></i>Profile
                </a>
                <a
                  href="{% url 'logout' %}"
                  class="flex items-center justify-center px-3 py-2 text-xs font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors"
                >
                  <i class="fas fa-sign-out-alt mr-1.5"></i>Logout
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Main Content Area -->
      <div class="flex-1 flex flex-col overflow-hidden">
        <!-- Top Bar (Desktop only) -->
        <header
          class="hidden lg:block bg-white border-b border-gray-200 px-6 py-4"
        >
          <div class="flex items-center justify-between">
            <div>
              <h2 class="text-2xl font-bold text-gray-900">
                {% block page_title %}{{ title }}{% endblock %}
              </h2>
              <p class="text-sm text-gray-500 mt-0.5">
                {% block page_description %}{% endblock %}
              </p>
            </div>

            <div class="flex items-center space-x-4">
              <a
                href="{% url 'notification_list' %}"
                class="relative p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200"
              >
                <i class="fas fa-bell text-xl"></i>
                {% if unread_notifications_count > 0 %}
                <span
                  class="absolute top-0 right-0 block h-5 w-5 rounded-full bg-blue-600 text-white text-xs flex items-center justify-center font-semibold animate-pulse"
                >
                  {{ unread_notifications_count }}
                </span>
                {% endif %}
              </a>

              <div
                class="flex items-center space-x-3 px-3 py-2 bg-gray-50 rounded-lg"
              >
                <div class="text-right">
                  <p class="text-sm font-semibold text-gray-900">
                    {{ user.get_full_name }}
                  </p>
                  <p class="text-xs text-gray-500">{{ user.email }}</p>
                </div>
                {% if user.profile_image %}
                <img src="{{ user.profile_image.url }}" alt="{{ user.get_full_name }}" class="w-10 h-10 rounded-full object-cover" id="profileImage">
                {% else %}
                <div
                  class="w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-700 rounded-full flex items-center justify-center text-white font-semibold shadow-lg"
                >
                  {{ user.first_name.0|upper }}{{ user.last_name.0|upper  }}
                </div>
                {% endif %}
              </div>
            </div>
          </div>
        </header>

        <!-- Main Content (ONLY CONTENT BLOCK IN ENTIRE FILE) -->
        <main
          class="flex-1 overflow-y-auto bg-gray-50 p-4 lg:p-6 {% if not user.is_authenticated %}pt-20{% else %}pt-20 lg:pt-6{% endif %}"
        >
          {% block content %}{% endblock %}
        </main>
      </div>
    </div>
    {% endif %}

    <!-- Alpine.js -->
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>

    <script>
      // Auto-dismiss flash messages after 5 seconds
      setTimeout(() => {
        document.querySelectorAll(".animate-slideDown").forEach((msg) => {
          msg.style.transition = "opacity 0.5s";
          msg.style.opacity = "0";
          setTimeout(() => msg.remove(), 500);
        });
      }, 5000);
    </script>

    {% block extra_js %}{% endblock %}

    <!-- Smartsupp Live Chat script -->
    <script type="text/javascript">
    var _smartsupp = _smartsupp || {};
    _smartsupp.key = '25264059777cceaedafecb5e474c45bbd244e964';
    window.smartsupp||(function(d) {
      var s,c,o=smartsupp=function(){ o._.push(arguments)};o._=[];
      s=d.getElementsByTagName('script')[0];c=d.createElement('script');
      c.type='text/javascript';c.charset='utf-8';c.async=true;
      c.src='https://www.smartsuppchat.com/loader.js?';s.parentNode.insertBefore(c,s);
    })(document);
    </script>
    <noscript>Powered by <a href="https://www.smartsupp.com" target="_blank">Smartsupp</a></noscript>
  </body>
</html>
